const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./PreviewMessage-DH3M83xK.js","./index-ITDkE3uC.js","./index-CRO32DBZ.css","./App-BfnndQAY.js","./PreviewMessage--BTGHUh8.css"])))=>i.map(i=>d[i]);
import{_ as P,j as e,R as _,a as b,c as z,Z as R,$ as T,a0 as y,a2 as C,a3 as E,a4 as S,a5 as w,r as d,a6 as D,a7 as F,a8 as p,a9 as H,aa as N}from"./index-ITDkE3uC.js";import{P as W,a as A,G as x,S as I}from"./App-BfnndQAY.js";import{H as g}from"./Header-BxEQANpx.js";import{F as M}from"./FormField-Chk75WAv.js";import{P as q,T as L}from"./PanelHeaderBack-B7MyZhRr.js";import{D as v}from"./Div-DAtCBXaj.js";import"./Title-CSXaCaFi.js";const O={vertical:"vkuiButtonGroup--mode-vertical",horizontal:"vkuiButtonGroup--mode-horizontal"},V={space:"vkuiButtonGroup--gap-space",s:"vkuiButtonGroup--gap-s",m:"vkuiButtonGroup--gap-m"},Z={left:"vkuiButtonGroup--align-left",center:"vkuiButtonGroup--align-center",right:"vkuiButtonGroup--align-right"},j=n=>{var{mode:o="horizontal",gap:i="m",stretched:a=!1,align:u="left"}=n,l=P(n,["mode","gap","stretched","align"]);return e.jsx(_,b({baseClassName:z("vkuiButtonGroup",O[o],i!=="none"&&V[i],a&&"vkuiButtonGroup--stretched",Z[u]),role:"group"},l))},$=R.lazy(()=>T(()=>import("./PreviewMessage-DH3M83xK.js"),__vite__mapDeps([0,1,2,3,4]),import.meta.url)),te=({id:n})=>{const o=y(),{openError:i}=C(),a=E(),u=S(),l=w(t=>t.tickets.tickets),[r,h]=d.useState(),[m,f]=d.useState("");d.useEffect(()=>{if(a&&a.id){const t=l.find(s=>s.id===a.id);t?h(t):D().then(s=>{u(F(s));const c=s.find(B=>B.id===a.id);c?h(c):o.push("/")}).catch(s=>{o.push("/"),i(s.response.data||"Возникла ошибка")})}},[]);function k(t,s){H(t,s).then(()=>{o.push("/")}).catch(c=>{i(c.response.data||"Возникла ошибка")})}function G(t){N(t).then(()=>{o.push("/")}).catch(s=>{i(s.response.data||"Возникла ошибка")})}return e.jsxs(W,{id:n,children:[e.jsx(A,{before:e.jsx(q,{onClick:()=>o.back()}),children:r==null?void 0:r.title}),r&&a&&e.jsxs(x,{children:[e.jsx(g,{children:"Предпросмотр тикета"}),r&&e.jsx($,{ticket:r}),e.jsx(I,{size:32}),!r.offer&&e.jsxs("div",{children:[e.jsxs(x,{style:{maxWidth:450,margin:"0 auto"},children:[e.jsx(g,{children:"Список корректировок"}),e.jsx(v,{children:r.corrections.map((t,s)=>e.jsxs("p",{children:[t.text," (",t.author,")"]},s))})]}),e.jsx(M,{top:"Описание доработок",style:{maxWidth:450,margin:"0 auto"},children:e.jsx(L,{id:"reason",name:"reason",placeholder:"Введите описание доработок",value:m,required:!0,onChange:t=>f(t.currentTarget.value)})}),e.jsx(v,{children:e.jsxs(j,{mode:"horizontal",gap:"m",stretched:!0,style:{maxWidth:450,margin:"0 auto"},children:[e.jsx(p,{onClick:()=>{k(a.id,m)},size:"l",appearance:"negative",stretched:!0,children:"На доработку"}),e.jsx(p,{onClick:()=>{G(a.id)},size:"l",appearance:"positive",stretched:!0,children:"На публикацию"})]})})]}),e.jsx(j,{mode:"horizontal",gap:"m",stretched:!0,style:{maxWidth:450,margin:"0 auto 12px"},children:e.jsx(p,{onClick:()=>{o.push("/new/"+a.id)},size:"l",stretched:!0,children:"Изменить"})})]})]})};export{te as Preview,te as default};
