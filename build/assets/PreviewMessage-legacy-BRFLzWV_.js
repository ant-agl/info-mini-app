System.register(["./index-legacy-iboyzMez.js","./App-legacy-DsSY3WDm.js"],(function(e,t){"use strict";var n,i,o,s,r,a,l,d,c,u,h,v,m,g,p,f,x,y,b,k,w,M,C,_,S,E,R,j,N,B,I,T,A,F,P,z,O,D,X,H,W,Y,L,G,$,V,q,Q,K,J,U,Z,ee,te,ne,ie,oe,se,re,ae,le,de,ce;return{setters:[e=>{n=e.r,i=e._,o=e.j,s=e.R,r=e.g,a=e.c,l=e.a,d=e.A,c=e.aZ,u=e.aL,h=e.b,v=e.aB,m=e.aC,g=e.q,p=e.a_,f=e.a$,x=e.b0,y=e.m,b=e.V,k=e.d,w=e.h,M=e.G,C=e.b1,_=e.b2,S=e.H,E=e.J,R=e.b3,j=e.b4,N=e.b5,B=e.t,I=e.i,T=e.aG,A=e.aE,F=e.ay,P=e.b6,z=e.b7,O=e.aD,D=e.b8,X=e.l,H=e.k,W=e.az,Y=e.n,L=e.b9,G=e.C,$=e.aP,V=e.e,q=e.p,Q=e.ba,K=e.bb,J=e.f,U=e.Z,Z=e.$,ee=e.bc},e=>{te=e.y,ne=e.z,ie=e.B,oe=e.D,se=e.E,re=e.M,ae=e.J,le=e.u,de=e.w,ce=e.K}],execute:function(){var ue=document.createElement("style");function he(e){return void 0!==e}function ve(e,t){return function(e,t,n){const i=t.filter(he);return i.length?e(...i):n}(Math.min,e,t)}ue.textContent='@import"https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300..800;1,300..800&display=swap";.message{width:350px;margin:0 auto 4px;border-radius:20px;overflow:hidden;background-color:#5d8fc2;border:1px solid #6595C5}.message__img{width:100%;overflow:hidden;border-bottom-left-radius:8px;border-bottom-right-radius:8px;margin:0}.message__img img{max-width:100%;display:block}.message__content{padding:15px 20px}.message__title,.message__description,.message__tags,.message__date,.file__name,.file__size{color:#fff;font-family:Open Sans,sans-serif;font-size:14px}.message__title{font-weight:700}.message__description,.message__tags{margin-top:12px}.message__date{font-style:italic;opacity:.7;text-align:right;font-size:12px}.file{display:flex;gap:7px;text-decoration:none;transition:.2s;border-radius:100px}.file:hover{background-color:rgba(255,255,255,.1)}.file:not(:first-child){margin-top:8px}.file__icon{width:40px;height:40px;border-radius:100px;background-color:#fff;display:flex;align-items:center;justify-content:center;color:#5d8fc2}.file__size{opacity:.8}.vkuiGridAvatar{width:100%!important;height:200px!important;border-radius:0}.gallery-overlay{position:fixed;top:0;left:0;width:100vw;height:100vh;z-index:1000;display:flex;align-items:center;justify-content:center;background-color:rgba(0,0,0,.4);transition:background-color .32s ease}.vkuiModalRoot__mask{display:none}\n',document.head.appendChild(ue);const me=n.createContext({size:0}),ge={stroke:"vkuiImageBaseBadge--background-stroke",shadow:"vkuiImageBaseBadge--background-shadow"},pe=e=>{var{background:t="shadow"}=e,n=i(e,["background"]);return o.jsx(s,r(l({},n),{baseClassName:a("vkuiImageBaseBadge",ge[t])}))};function fe(e=!0){const{hasPointer:t}=n.useContext(d);return te(!(e||void 0===t))&&void 0===t?c:t}pe.displayName="ImageBaseBadge";const xe=e=>{var{children:t,className:n,getRootRef:s,disableInteractive:d,overlayShown:c}=e,u=i(e,["children","className","getRootRef","disableInteractive","overlayShown"]);const h=v(),{focusVisible:g}=h,f=i(h,["focusVisible"]),x=m({focusVisible:g,mode:"inside"}),y=p();return o.jsx("div",r(l(r(l({},u),{tabIndex:0,role:"button",className:a("vkuiImageBaseOverlay--clickable",(g||c)&&"vkuiImageBaseOverlay--visible",x,n),ref:s}),f,y),{children:t}))},ye=e=>{var{className:t,getRootRef:s,disableInteractive:d,overlayShown:c}=e,v=i(e,["className","getRootRef","disableInteractive","overlayShown"]);const m=g(s),{shown:p,onClick:f}=function(e){const t=u(e),[i,o]=n.useState(!1);return h((()=>{o(t)}),[t]),{shown:i&&t,onClick:function(e){e.detail>0&&o(!1)}}}(m);return o.jsx("div",r(l({},v),{ref:m,className:a((p||c)&&"vkuiImageBaseOverlay--visible",t),onClick:f}))},be=e=>{var{className:t,theme:n,visibility:s}=e,r=i(e,["className","theme","visibility"]);const d=ne(),c=fe(),u=null!=n?n:d,h=null!=s?s:c?"on-hover":"always",v={className:a("vkuiImageBaseOverlay","light"===u&&"vkuiImageBaseOverlay--theme-light","dark"===u&&"vkuiImageBaseOverlay--theme-dark",t),overlayShown:"always"===h};return r.disableInteractive?o.jsx(ye,l({},r,v)):o.jsx(xe,l({},r,v))};be.displayName="ImageBaseOverlay";const ke=e=>{var{alt:t,crossOrigin:s,decoding:d,loading:c,referrerPolicy:u,sizes:h,src:v,srcSet:m,useMap:p,fetchPriority:y,getRef:b,size:k,width:w,height:M,widthSize:C,heightSize:_,style:S,noBorder:E=!1,fallbackIcon:R,children:j,onLoad:N,onError:B,withTransparentBackground:I}=e,T=i(e,["alt","crossOrigin","decoding","loading","referrerPolicy","sizes","src","srcSet","useMap","fetchPriority","getRef","size","width","height","widthSize","heightSize","style","noBorder","fallbackIcon","children","onLoad","onError","withTransparentBackground"]);const A=null!=k?k:ve([C,_],24),F=null!=C?C:A,P=null!=_?_:A,[z,O]=n.useState(!1),[D,X]=n.useState(!1),H=v||m,W=!D&&H||!n.isValidElement(R)?null:R,Y=g(b),L=n.useRef(!1);return n.useEffect((function(){if(!L.current&&(L.current=!0,Y.current&&Y.current.complete&&!z)){const e=new Event("load");Y.current.dispatchEvent(e)}}),[Y,z]),o.jsx(me.Provider,{value:{size:A},children:o.jsxs(f,r(l({style:l({width:F,height:P},S),baseClassName:a("vkuiImageBase",z&&"vkuiImageBase--loaded",I&&"vkuiImageBase--transparent-background")},T),{children:[H&&o.jsx("img",l({ref:Y,alt:t,className:"vkuiImageBase__img",crossOrigin:s,decoding:d,loading:c,referrerPolicy:u,sizes:h,src:v,srcSet:m,useMap:p,width:w,height:M,onLoad:e=>{z||(O(!0),X(!1),null==N||N(e))},onError:e=>{O(!1),X(!0),null==B||B(e)}},x(y))),W&&o.jsx("div",{className:"vkuiImageBase__fallback",children:W}),j,!E&&o.jsx("div",{"aria-hidden":!0,className:"vkuiImageBase__border"})]}))})};ke.displayName="ImageBase",(ke.Badge=pe).displayName="ImageBase.Badge",(ke.Overlay=be).displayName="ImageBase.Overlay";var we=y("Icon20Cancel","cancel_20","0 0 20 20",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 20" id="cancel_20"><path fill="currentColor" fill-rule="evenodd" d="M4.72 4.72a.75.75 0 0 1 1.06 0L10 8.94l4.22-4.22a.75.75 0 1 1 1.06 1.06L11.06 10l4.22 4.22a.75.75 0 1 1-1.06 1.06L10 11.06l-4.22 4.22a.75.75 0 0 1-1.06-1.06L8.94 10 4.72 5.78a.75.75 0 0 1 0-1.06" clip-rule="evenodd" /></symbol>',20,20),Me=y("Icon20DocumentOutline","document_outline_20","0 0 20 20",'<symbol xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 20 20" id="document_outline_20"><path fill-rule="evenodd" d="M10.175 1.5H9c-.806 0-1.465.006-2.01.05-.63.052-1.172.16-1.67.413a4.25 4.25 0 0 0-1.857 1.858c-.253.497-.361 1.04-.413 1.67C3 6.103 3 6.864 3 7.816v4.366c0 .952 0 1.713.05 2.327.052.63.16 1.172.413 1.67a4.25 4.25 0 0 0 1.858 1.857c.497.253 1.04.361 1.67.413.613.05 1.374.05 2.326.05h1.366c.952 0 1.713 0 2.327-.05.63-.052 1.172-.16 1.67-.413a4.25 4.25 0 0 0 1.857-1.857c.253-.498.361-1.04.413-1.67.05-.614.05-1.375.05-2.327V8.325c0-.489 0-.733-.055-.963q-.075-.309-.24-.579c-.123-.201-.296-.374-.642-.72l-3.626-3.626c-.346-.346-.519-.519-.72-.642a2 2 0 0 0-.579-.24c-.23-.055-.474-.055-.963-.055M15.5 12.15c0 .992 0 1.692-.045 2.238-.044.537-.127.86-.255 1.11A2.75 2.75 0 0 1 14 16.7c-.252.128-.574.21-1.111.255-.546.044-1.245.045-2.238.045h-1.3c-.992 0-1.692 0-2.238-.045-.537-.044-.86-.127-1.11-.255A2.75 2.75 0 0 1 4.8 15.5c-.128-.252-.21-.574-.255-1.111-.044-.546-.045-1.245-.045-2.238v-4.3c0-.992 0-1.692.045-2.238.044-.537.127-.86.255-1.11A2.75 2.75 0 0 1 6.002 3.3c.25-.128.573-.21 1.11-.255C7.658 3.001 8.358 3 9.35 3H10v2.35c0 .409 0 .761.024 1.051.026.306.083.61.238.902.21.398.537.724.935.935.291.155.596.212.902.238.29.024.642.024 1.051.024h2.35zM14.879 7 11.5 3.621V5.32c0 .447 0 .736.02.955.017.21.047.288.067.326a.75.75 0 0 0 .312.312c.038.02.116.05.326.068.22.018.508.019.955.019z" clip-rule="evenodd" /></symbol>',20,20),Ce=y("Icon24Chevron","chevron_24","0 0 16 24",'<symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 24" id="chevron_24"><g fill="none" fill-rule="evenodd"><path d="M0 0h16v24H0z" /><path fill="currentColor" d="M4.706 7.706a1 1 0 0 1 0-1.412l.088-.088a.997.997 0 0 1 1.414.002l5.084 5.084a1 1 0 0 1 0 1.416l-5.084 5.084a1 1 0 0 1-1.414.002l-.088-.088a.995.995 0 0 1 0-1.412L9 12z" /></g></symbol>',16,24);const _e={m:"vkuiScrollArrow--size-m",l:"vkuiScrollArrow--size-l"},Se={up:"vkuiScrollArrow--direction-up",right:"vkuiScrollArrow--direction-right",down:"vkuiScrollArrow--direction-down",left:"vkuiScrollArrow--direction-left"},Ee={up:"Назад",right:"Вперед",down:"Вперед",left:"Назад"},Re=({size:e})=>{let t=Ce;return"m"===e&&(t=ie),o.jsx(t,{className:"vkuiScrollArrow__defaultIcon"})},je=e=>{var{size:t="l",offsetY:n,direction:d,label:c,children:u=o.jsx(Re,{size:t})}=e,h=i(e,["size","offsetY","direction","label","children"]);const v=null!=c?c:Ee[d];return o.jsxs(s,r(l({Component:"button",type:"button",baseClassName:a("vkuiScrollArrow",_e[t],Se[d])},h),{children:[v&&o.jsx(b,{children:v}),o.jsx("span",{className:"vkuiScrollArrow__icon",style:n?{top:n}:void 0,children:u})]}))};function Ne(e,t){return null!=e?e:t}const Be=()=>{k||console.error("[useAdaptivityWithJSMediaQueries] Похоже, вы пытаетесь использовать хук вне браузера.\n\nПостарайтесь этого избегать, чтобы не было ошибок при гидратации: при SSR нет информации о размерах экрана.\n\nИспользуйте CSS Media Query или библиотеку по типу https://github.com/artsy/fresnel.");const{viewWidth:e,viewHeight:t,sizeX:i,sizeY:o,hasPointer:s,hasHover:r}=n.useContext(d),a=w(),l=M(),[[u,h],v]=n.useState((()=>[Ne(e,C(l)),Ne(t,_(l))])),m=n.useMemo((()=>{const n=Ne(s,c),l=Ne(r,R),d=Ne(e,u),v=Ne(t,h);return{viewWidth:d,viewHeight:v,sizeX:Ne(i,j(d)),sizeY:Ne(o,N(d,v,n)),hasPointer:n,hasHover:l,isDesktop:B(d,v,n,a)}}),[u,h,e,t,i,o,s,r,a]);return n.useEffect((()=>{const n=()=>{v((n=>{const i=Ne(e,C(l)),o=Ne(t,_(l)),[s,r]=n;return s!==i||r!==o?[i,o]:n}))};return e||[l.desktopPlus,l.tablet,l.smallTablet,l.mobile].forEach((e=>S(e,n))),t||[l.mediumHeight,l.mobileLandscapeHeight].forEach((e=>S(e,n))),()=>{[l.desktopPlus,l.tablet,l.smallTablet,l.mobile,l.mediumHeight,l.mobileLandscapeHeight].forEach((e=>E(e,n)))}}),[l,e,t]),m},Ie=D.join(),Te=e=>{var{Component:t="div",onClose:s,autoFocus:a=!0,restoreFocus:d=!0,disabled:c=!1,mount:u=!0,timeout:v=0,getRootRef:m,children:p}=e,f=i(e,["Component","onClose","autoFocus","restoreFocus","disabled","mount","timeout","getRootRef","children"]);const x=g(m),{document:y}=I(),b=n.useRef([]),[k,w]=n.useState(null),M=e=>{const t=e.querySelectorAll(Ie),n=[];t.forEach((e=>{const{display:t,visibility:i}=getComputedStyle(e);"none"!==t&&"hidden"!==i&&n.push(e)})),0===n.length&&n.push(e),b.current=n},C=e=>{const t=[...b.current];var n,i;if(M(e),n=t,i=b.current,(n.length!==i.length||!n.every(((e,t)=>e===i[t])))&&y){const e=y.activeElement;(e=>{const t=b.current[e];t&&t.focus({preventScroll:!0})})(Math.max(y.activeElement?b.current.indexOf(e):-1,0))}};h((function(){if(!x.current)return;const e=x.current,t=new MutationObserver((()=>C(e)));return t.observe(x.current,{subtree:!0,childList:!0}),M(e),()=>t.disconnect()}),[x]),h((function(){if(!x.current||!a||c)return;const e=setTimeout((()=>{if(!x.current||!b.current.length)return;const e=T(x.current);A(x.current,e)||b.current[0].focus()}),v);return()=>{clearTimeout(e)}}),[a,v,c]);const _=n.useCallback((()=>{const e="function"==typeof d?d():d;k&&F(k)&&e&&setTimeout((()=>{k&&(k.focus(),w(null))}),v)}),[d,k,v]);return h((function(){x.current&&d&&u?w(T(x.current)):w(null)}),[x,u,d]),h((function(){return()=>_()}),[_]),h((function(){u||_()}),[u,_]),h((()=>{if(!x.current)return;const e=e=>{if(!c){switch(z(e)){case O.TAB:{if(!b.current.length)return!1;const t=b.current.length-1,n=b.current.findIndex((t=>t===e.target)),i=-1===n||n===t&&!e.shiftKey;if(i||0===n&&e.shiftKey){e.preventDefault();const n=b.current[i?0:t];return n!==T(n)&&n.focus(),!1}break}case O.ESCAPE:s&&(e.preventDefault(),s())}return!0}},t=P(x.current).document;return t.addEventListener("keydown",e,{capture:!0}),()=>{t.removeEventListener("keydown",e,!0)}}),[s,x,c]),o.jsx(t,r(l({tabIndex:-1,ref:x},f),{children:p}))},Ae=e=>{var{children:t="Закрыть",className:n}=e,s=i(e,["children","className"]);return o.jsxs(X,r(l({className:a("vkuiModalDismissButton",n)},s),{activeMode:"vkuiModalDismissButton--active",hoverMode:"vkuiModalDismissButton--hover",children:[t&&o.jsx(b,{children:t}),o.jsx(we,{})]}))},Fe=n.createContext(!1);function Pe(e,t){if("setActive"===t.type&&t.id!==e.activeModal){const n=t.id,i=e.exitingModal||e.activeModal;let o=e.history?[...e.history]:[];const s=Boolean(n&&o.includes(n));return null===n?o=[]:s?o=o.splice(0,o.indexOf(n)+1):o.push(n),{activeModal:n,enteringModal:null,exitingModal:i,history:o,isBack:s}}return"entered"===t.type&&t.id===e.enteringModal?r(l({},e),{enteringModal:null}):"exited"===t.type&&t.id===e.exitingModal?r(l({},e),{exitingModal:null}):"inited"===t.type&&t.id===e.activeModal?r(l({},e),{enteringModal:t.id}):e}function ze(e,t,i=Y,o=Y,s=Y,a=Y,d=Y){const c=n.useRef({}).current;(function(e){return n.Children.toArray(e)})(t).forEach((e=>{const t=e.props,n=oe(t),i=void 0!==n&&c[n]||{id:null!=n?n:null};i.onOpen=e.props.onOpen,i.onOpened=e.props.onOpened,i.onClose=e.props.onClose,i.onClosed=e.props.onClosed,i.preventClose=e.props.preventClose,"number"==typeof t.settlingHeight&&(i.settlingHeight=t.settlingHeight),null!==i.id&&(c[i.id]=i)}));const u=e&&!c[e]?null:e,[v,m]=n.useReducer(Pe,{activeModal:u,enteringModal:null,exitingModal:null,history:u?[u]:[],isBack:!1});h((()=>{m({type:"setActive",id:null!=u?u:null})}),[e]),h((()=>{v.activeModal&&(d(c[v.activeModal]),m({type:"inited",id:v.activeModal}))}),[v.activeModal]);const g=e=>{var t;return null!=e&&"card"===(null===(t=c[e])||void 0===t?void 0:t.type)},p=n.useCallback((e=>{if(e){const t=c[e];W(t.onOpened)?t.onOpened():W(o)&&o(e)}m({type:"entered",id:e})}),[c,o]),f=n.useCallback((e=>{if(e){const t=c[e];W(t.onClosed)?t.onClosed():W(a)&&a(e)}m({type:"exited",id:e})}),[c,a]),x=Boolean(v.exitingModal&&(g(e)||g(v.exitingModal))),y=n.useCallback((e=>e?c[e]:void 0),[c]);return r(l({onEnter:function(){const e=v.activeModal&&c[v.activeModal];e&&(W(e.onOpen)?e.onOpen():W(i)&&e.id&&i(e.id))},onEntered:p,onExit:function(){const e=v.activeModal&&c[v.activeModal];e&&!e.preventClose&&(W(e.onClose)?e.onClose():W(s)&&e.id&&s(e.id))},onExited:f},v),{delayEnter:x,getModalState:y})}const Oe=function(e){const t=new Set;return(n,i="warn")=>{if(!t.has(n)){t.add(n);const o=`%c[VKUI/${e}] ${n}`,s="log"===i?"color: steelblue; font-style: italic":void 0;console[i](o,s)}}}("ModalRoot");function De(e,t){return!!t&&e>=t[0]&&e<=t[1]}function Xe(e){return $(e,0,98)}class He extends n.Component{get timeout(){return"ios"===this.props.platform?400:320}get document(){return this.props.document}get window(){return this.props.window}getModals(){return n.Children.toArray(this.props.children)}componentDidMount(){var e;null===(e=this.window)||void 0===e||e.addEventListener("resize",this.updateModalHeight,!1)}componentWillUnmount(){this.toggleDocumentScrolling(!0),this.window.removeEventListener("resize",this.updateModalHeight,!1)}componentDidUpdate(e){if(this.props.exitingModal&&this.props.exitingModal!==e.exitingModal&&this.closeModal(this.props.exitingModal),this.props.enteringModal&&this.props.enteringModal!==e.enteringModal){const e=this.props.getModalState(this.props.enteringModal);this.props.onEnter(),this.waitTransitionFinish(e,(()=>{e&&(e.innerElement&&(e.innerElement.style.transitionDelay=""),this.onEntered(e))})),(null==e?void 0:e.innerElement)&&(e.innerElement.style.transitionDelay=this.props.delayEnter?`${this.timeout}ms`:"",this.animateTranslate(e,e.translateY),this.setMaskOpacity(e,1))}this.props.activeModal&&!e.activeModal&&(this.restoreFocusTo=this.document.activeElement),this.props.activeModal||this.props.exitingModal||!this.restoreFocusTo||(this.restoreFocusTo.focus(),this.restoreFocusTo=null),this.toggleDocumentScrolling(!this.props.activeModal&&!this.props.exitingModal)}toggleDocumentScrolling(e){this.documentScrolling!==e&&(this.documentScrolling=e,e?(this.document.documentElement.classList.remove("vkui--disable-overscroll-behavior"),this.window.removeEventListener("touchmove",this.preventTouch,{passive:!1})):(this.document.documentElement.classList.add("vkui--disable-overscroll-behavior"),this.window.addEventListener("touchmove",this.preventTouch,{passive:!1})))}checkPageContentHeight(){const e=this.props.getModalState(this.props.activeModal);if("page"===(null==e?void 0:e.type)&&(null==e?void 0:e.modalElement)){const t=l({},e);Le(e);const n=l({},e);let i=!1;t.expandable===n.expandable?t.translateYFrom!==n.translateYFrom&&(i=!0):i=!0,i&&this.animateTranslate(e,e.translateY)}}onEntered({id:e,modalElement:t}){this.props.noFocusToDialog||!t||t.contains(this.document.activeElement)||t.focus(),this.props.onEntered(e)}closeModal(e){this.setState({touchDown:!1});const t=this.props.getModalState(e);if(!t)return void(e&&Oe(`closeActiveModal: модальное окно (страница) ${e} не существует`,"error"));this.state.modalOpenedLog.length||this.setState((t=>({modalOpenedLog:[...t.modalOpenedLog,e]})));const n=this.props.getModalState(this.props.activeModal),i=!!n&&"page"===n.type,o=!!t&&"page"===t.type;var s,r,a;this.waitTransitionFinish(t,(()=>this.props.onExited(e)));const l=o&&i&&(null!==(s=t.translateY)&&void 0!==s?s:0)<=(null!==(r=null==n?void 0:n.translateYFrom)&&void 0!==r?r:0)&&!this.props.isBack?(null!==(a=null==n?void 0:n.translateYFrom)&&void 0!==a?a:0)+10:100;this.animateTranslate(t,l),n?n.id&&!this.state.modalOpenedLog.includes(n.id)&&(n.translateY=void 0,this.setState((e=>({modalOpenedLog:[...e.modalOpenedLog,n.id]})))):(this.setMaskOpacity(t,0),this.setState({modalOpenedLog:[]}),t.translateY=void 0,t.expandable=void 0)}onPageTouchMove(e,t){var n,i;const{shiftY:o,originalEvent:s}=e,r=s.target;var a;if(!e.isY)return void((null===(a=this.viewportRef.current)||void 0===a?void 0:a.contains(r))&&s.preventDefault());if(!(null===(n=t.innerElement)||void 0===n?void 0:n.contains(r)))return s.preventDefault();s.stopPropagation();const{expandable:l,contentScrolled:d,collapsed:c,expanded:u}=t;var h,v;if(this.state.touchDown||(t.touchStartContentScrollTop=null!==(v=null===(h=t.contentElement)||void 0===h?void 0:h.scrollTop)&&void 0!==v?v:0,this.setState({touchDown:!0})),!d&&(null===t.touchMovePositive&&(t.touchMovePositive=o>0),!t.expandable||c||u&&t.touchMovePositive&&0===t.touchStartContentScrollTop||(null===(i=t.headerElement)||void 0===i?void 0:i.contains(r)))){if(s.preventDefault(),!l&&o<0||!this.window)return;!this.state.dragging&&this.setState({dragging:!0});const e=o/this.window.innerHeight*100,n=se(e,72,.8,"ios"!==this.props.platform);var m;t.touchShiftYPercent=e,t.translateYCurrent=Xe((null!==(m=t.translateY)&&void 0!==m?m:0)+n),this.animateTranslate(t,t.translateYCurrent),this.setMaskOpacity(t)}}onCardTouchMove(e,t){var n;const{originalEvent:i,shiftY:o}=e,s=i.target;if(null===(n=t.innerElement)||void 0===n?void 0:n.contains(s)){this.state.touchDown||this.setState({touchDown:!0,dragging:!0});const e=o/t.innerElement.offsetHeight*100,n=se(e,72,1.2,"ios"!==this.props.platform);var r;t.touchShiftYPercent=e,t.translateYCurrent=Math.max(0,(null!==(r=t.translateY)&&void 0!==r?r:0)+n),this.animateTranslate(t,t.translateYCurrent),this.setMaskOpacity(t)}}onPageTouchEnd(e,t){const{startY:n,shiftY:i}=e;let o;if(t.contentScrolled=!1,t.touchMovePositive=null,this.state.dragging&&this.window){const v=(n+i)/this.window.innerHeight*100;var s;let m=null!==(s=t.translateYCurrent)&&void 0!==s?s:0;var r,a,l,d;if(m=Xe(m+m/e.duration*240*.6*((null!==(r=t.touchShiftYPercent)&&void 0!==r?r:0)<0?-1:1)),100!==t.settlingHeight)if(De(m,t.expandedRange))m=null!==(l=null===(a=t.expandedRange)||void 0===a?void 0:a[0])&&void 0!==l?l:0;else if(De(m,t.collapsedRange)){var c;m=null!==(c=t.translateYFrom)&&void 0!==c?c:0}else if(De(m,t.hiddenRange)){var u;m=t.preventClose?null!==(u=t.translateYFrom)&&void 0!==u?u:0:100}else{var h;m=null!==(h=t.translateYFrom)&&void 0!==h?h:0}else m=De(m,[0,25])?0:t.preventClose?null!==(d=t.translateYFrom)&&void 0!==d?d:0:100;100!==m&&v>=75&&!t.preventClose&&(m=100),t.translateY=m,t.translateYCurrent=m,t.collapsed=De(m,t.collapsedRange),t.expanded=0===m,t.hidden=100===m,t.hidden&&this.props.onExit(),o=()=>{t.hidden||this.animateTranslate(t,t.translateY),this.setMaskOpacity(t)}}this.setState({touchDown:!1,dragging:!1},o)}onCardTouchEnd({duration:e},t){let n;if(this.state.dragging){var i;let s=null!==(i=t.translateYCurrent)&&void 0!==i?i:0;var o;const r=s/e*240*.6*((null!==(o=t.touchShiftYPercent)&&void 0!==o?o:0)<0?-1:1);s=Math.max(0,s+r),s=s>=30?100:0,t.translateY=s,t.hidden=100===s,t.hidden&&this.props.onExit(),n=()=>{t.hidden||this.animateTranslate(t,t.translateY),this.setMaskOpacity(t)}}this.setState({touchDown:!1,dragging:!1},n)}waitTransitionFinish(e,t){const n=e?e.innerElement:null;n?n.addEventListener("transitionend",t,{once:!0}):setTimeout(t,this.timeout)}animateTranslate(e,t){const n=`animateTranslateFrame${e.id}`;cancelAnimationFrame(this.frameIds[n]),this.frameIds[n]=requestAnimationFrame((()=>{var n,i;n=e.innerElement,i=`translate3d(0, ${t}%, 0)`,n&&(n.style.transform=i,n.style.webkitTransform=i)}))}setMaskOpacity(e,t=null){var n;null===t&&(null===(n=this.props.history)||void 0===n?void 0:n[0])!==e.id||(this.maskAnimationFrame&&cancelAnimationFrame(this.maskAnimationFrame),this.maskAnimationFrame=requestAnimationFrame((()=>{if(this.maskElementRef.current){const{translateY:n=0,translateYCurrent:i=0}=e,o=null===t?1-(i-n)/(100-n)||0:t;this.maskElementRef.current.style.opacity=$(o,0,100).toString(),this.maskElementRef.current.style.transitionDelay=o&&this.props.delayEnter?`${this.timeout}ms`:""}})))}render(){var e;const{activeModal:t,exitingModal:n,enteringModal:i,modalOverlayTestId:s}=this.props,{touchDown:r,dragging:d}=this.state;return t||n?o.jsx(Fe.Provider,{value:!0,children:o.jsx(re.Provider,{value:this.modalRootContext,children:o.jsxs(ae,{className:a("vkuiModalRoot",(null===(e=this.props.configProvider)||void 0===e?void 0:e.hasCustomPanelHeaderAfter)&&"vkuiModalRoot--hasCustomPanelHeaderAfterSlot",r&&a("vkuiModalRoot--touched","vkuiInternalModalRoot--touched"),!(!i&&!n)&&a("vkuiModalRoot--switching","vkuiInternalModalRoot--switching")),onMove:this.onTouchMove,onEnd:this.onTouchEnd,onScroll:this.onScroll,children:[o.jsx("div",{"data-testid":s,className:"vkuiModalRoot__mask",onClick:this.props.onExit,ref:this.maskElementRef}),o.jsx("div",{className:"vkuiModalRoot__viewport",ref:this.viewportRef,children:this.getModals().map((e=>{const i=oe(e.props),s=this.props.getModalState(i);if(i!==t&&i!==n||!s)return null;const r=l({},s),c="page"===r.type,u=`modal-${i}`;return o.jsx(Te,{onClose:this.props.onExit,timeout:this.timeout,className:a("vkuiModalRoot__modal",d&&"vkuiInternalModalRoot__modal--dragging",c&&r.expandable&&"vkuiInternalModalRoot__modal--expandable",c&&r.collapsed&&"vkuiInternalModalRoot__modal--collapsed"),autoFocus:!1,restoreFocus:!1,children:e},u)}))})]})})}):null}constructor(e){super(e),V(this,"documentScrolling",!1),V(this,"maskElementRef",void 0),V(this,"viewportRef",n.createRef()),V(this,"maskAnimationFrame",void 0),V(this,"modalRootContext",void 0),V(this,"frameIds",void 0),V(this,"restoreFocusTo",void 0),V(this,"preventTouch",(e=>{if(!e)return!1;for(;e.originalEvent;)e=e.originalEvent;return e.preventDefault&&e.preventDefault(),!1})),V(this,"updateModalHeight",(()=>{const e=this.props.getModalState(this.props.activeModal);e&&"page"===e.type&&(this.props.enteringModal?this.waitTransitionFinish(e,(()=>{requestAnimationFrame((()=>this.checkPageContentHeight()))})):requestAnimationFrame((()=>this.checkPageContentHeight())))})),V(this,"onTouchMove",(e=>{if(this.props.exitingModal)return;const t=this.props.getModalState(this.props.activeModal);return t?"page"===t.type?this.onPageTouchMove(e,t):"card"===t.type?this.onCardTouchMove(e,t):void 0:void 0})),V(this,"onTouchEnd",(e=>{const t=this.props.getModalState(this.props.activeModal);return"page"===(null==t?void 0:t.type)?this.onPageTouchEnd(e,t):"card"===(null==t?void 0:t.type)?this.onCardTouchEnd(e,t):void 0})),V(this,"onScroll",(e=>{var t;const n=this.props.activeModal,i=e.target;if(!n)return;const o=this.props.getModalState(n);"page"===(null==o?void 0:o.type)&&(null==o||null===(t=o.contentElement)||void 0===t?void 0:t.contains(i))&&(o.contentScrolled=!0,o.contentScrollStopTimeout&&clearTimeout(o.contentScrollStopTimeout),o.contentScrollStopTimeout=setTimeout((()=>{o.contentScrolled&&(o.contentScrolled=!1)}),250))})),this.state={touchDown:!1,dragging:!1,modalOpenedLog:[]},this.maskElementRef=n.createRef(),this.modalRootContext={updateModalHeight:this.updateModalHeight,registerModal:e=>{var t,{id:n}=e,o=i(e,["id"]);return Object.assign(null!==(t=this.props.getModalState(n))&&void 0!==t?t:{},o)},onClose:()=>this.props.onExit(),isInsideModal:!0},this.frameIds={}}}const We=function(e,t,i){return function(s){const a=n.useContext(t);return o.jsx(e,r(l({},s),{[i]:a}))}}((Ye=L(function(e=Y){return function(t){return function(n){const i=ze(n.activeModal,n.children,n.onOpen,n.onOpened,n.onClose,n.onClosed,e);return o.jsx(t,l({},n,i))}}}((function(e){switch(e.type){case"page":return e.settlingHeight=e.settlingHeight||75,Le(e);case"card":return function(e){e.translateY=0}(e)}}))(He)),function(e){const{platform:t}=H();return o.jsx(Ye,r(l({},e),{platform:t}))}),G,"configProvider");var Ye;function Le(e){const{contentElement:t,bottomInset:n}=e,i=function(e,t){if(!t)return e.scrollHeight;const n=e.style.height;e.style.height="auto";const i=e.scrollHeight;return e.style.height=n,i}(null==t?void 0:t.firstElementChild,e.expandable)+((null==n?void 0:n.offsetHeight)||0);let o=e.translateY,s=e.expandable;var r;e.expandable=i>(null!==(r=null==t?void 0:t.clientHeight)&&void 0!==r?r:0)||100===e.settlingHeight;let a,l,d,c,u,h=!1,v=!1;const m=Boolean(e.expandable&&100!==e.settlingHeight);if(e.expandable){var g;a=100-(null!==(g=e.settlingHeight)&&void 0!==g?g:0);const t=a/2,n=100-a;d=[0,t],c=m?[t,a+n/4]:void 0,u=[a+n/4,100],h=m&&a>0,v=a<=0,l=a}else{var p,f,x,y,b;a=100-(i+(null!==(y=null===(p=e.headerElement)||void 0===p?void 0:p.offsetHeight)&&void 0!==y?y:0))/(null!==(b=null===(x=e.innerElement)||void 0===x||null===(f=x.parentElement)||void 0===f?void 0:f.offsetHeight)&&void 0!==b?b:0)*100,l=a,d=[l,l+25],c=void 0,u=[l+25,l+100]}(s&&e.expandable&&l>(null!=o?o:100)||100===e.settlingHeight)&&(l=0),0===l&&(v=!0,h=!1),e.expandedRange=d,e.collapsedRange=c,e.hiddenRange=u,e.translateY=l,e.translateYFrom=a,e.collapsed=h,e.expanded=v}const Ge=({activeModal:e,children:t,noFocusToDialog:s=!1,onOpen:r,onOpened:l,onClose:d,onClosed:c,modalOverlayTestId:u})=>{const h=n.useRef(null),v=n.useRef(void 0),m=n.useRef(void 0),{document:g}=I(),{hasCustomPanelHeaderAfter:p,platform:f}=H(),{activeModal:x,exitingModal:y,onExit:b,getModalState:k,enteringModal:w,onEnter:M,onEntered:C,onExited:_,history:S,delayEnter:E}=ze(e,t,r,l,d,c,Y),R=(()=>{const e=n.useRef(null),{document:t}=I(),i=n.useRef(Y),o=n.useCallback((()=>{i.current(),i.current=Y}),[]);return n.useCallback(((n,s,r)=>{n&&((null==t?void 0:t.hidden)?((null==e?void 0:e.current)&&clearTimeout(e.current),e.current=setTimeout(s,r)):(o(),n.addEventListener("transitionend",s),i.current=()=>{n.removeEventListener("transitionend",s)}))}),[t,o,e])})(),j=le({exitingModal:y,enteringModal:w,activeModal:x}),N=q({updateModalHeight:()=>{},registerModal:e=>{var t,{id:n}=e,o=i(e,["id"]);return Object.assign(null!==(t=k(n))&&void 0!==t?t:{},o)},onClose:b,isInsideModal:!0}),B="ios"===f?400:320,T=n.Children.toArray(t),A=(e,t)=>{(null==e?void 0:e.innerElement)&&(e.innerElement.style.transition="",e.innerElement.style.transitionDelay=t&&E?`${B}ms`:"",e.innerElement.style.opacity=t?"1":"0")},F=(e,t=null)=>{null===t&&(null==S?void 0:S[0])!==e.id||(v.current&&cancelAnimationFrame(v.current),v.current=requestAnimationFrame((()=>{if(h.current){const{translateY:n=0,translateYCurrent:i=0}=e,o=null===t?1-(i-n)/(100-n)||0:t;h.current.style.opacity=$(o,0,100).toString()}})))},P=({id:e,modalElement:t})=>{s||!t||t.contains(g.activeElement)||t.focus(),C(e)};return n.useEffect((()=>{var e;j&&(y&&y!==j.exitingModal&&(e=>{const t=k(e);t&&(x?_(e):requestAnimationFrame((()=>{R(null==t?void 0:t.innerElement,(()=>_(e)),B),A(t,!1),F(t,0)})))})(y),w&&w!==j.enteringModal&&(()=>{if(!w||!j)return;const e=k(w);M(),j.exitingModal?(requestAnimationFrame((()=>{(null==e?void 0:e.innerElement)&&(e.innerElement.style.transition="none",e.innerElement.style.opacity="1",F(e,1))})),e&&P(e)):requestAnimationFrame((()=>{w==w&&e&&(R(e.innerElement,(()=>P(e)),B),A(e,!0),F(e,1))}))})(),x&&!j.activeModal&&(m.current=null!==(e=null==g?void 0:g.activeElement)&&void 0!==e?e:void 0),x||y||!m.current||(m.current.focus(),m.current=void 0))})),x||y?o.jsx(re.Provider,{value:N,children:o.jsxs("div",{className:a("vkuiModalRoot",p&&"vkuiModalRoot--hasCustomPanelHeaderAfterSlot","vkuiModalRoot--desktop"),children:[o.jsx("div",{"data-testid":u,className:"vkuiModalRoot__mask",ref:h,onClick:b}),o.jsx("div",{className:"vkuiModalRoot__viewport",children:T.map((e=>{const t=oe(e.props);if(t!==x&&t!==y)return null;const n=`modal-${t}`;return o.jsx(Te,{autoFocus:!1,restoreFocus:!1,onClose:b,timeout:B,className:"vkuiModalRoot__modal",children:e},n)}))})]})}):null},$e=e=>{const{isDesktop:t}=Be();Q(!!e.activeModal);const n=t?Ge:We;return o.jsx(n,l({},e))};function Ve(e){var t,n,i;return e&&90===Math.abs(null!==(i=null===(n=e.screen)||void 0===n||null===(t=n.orientation)||void 0===t?void 0:t.angle)&&void 0!==i?i:Number(e.orientation))?"landscape":"portrait"}const qe=n.createContext({}),Qe={s:"vkuiModalPage--size-s",m:"vkuiModalPage--size-m",l:"vkuiModalPage--size-l"},Ke=e=>{var{children:t,header:d,size:c="s",onOpen:u,onOpened:h,onClose:v,onClosed:m,settlingHeight:p,dynamicContentHeight:f,getModalContentRef:x,nav:y,id:b,hideCloseButton:k=!1,height:M,modalContentTestId:C,modalDismissButtonTestId:_,getRootRef:S,preventClose:E}=e,R=i(e,["children","header","size","onOpen","onOpened","onClose","onClosed","settlingHeight","dynamicContentHeight","getModalContentRef","nav","id","hideCloseButton","height","modalContentTestId","modalDismissButtonTestId","getRootRef","preventClose"]);const j=n.useId(),N=b||j,{updateModalHeight:B}=n.useContext(re),T=w(),A=function(){const{window:e}=I(),[t,i]=n.useState((()=>Ve(e)));return de(e,"orientationchange",(()=>i(Ve(e)))),t}(),{sizeX:F,isDesktop:P}=Be();n.useEffect((()=>{f&&B()}),[t,f,A,B]);const z=!k&&P,O=P?c:"s",D=n.useContext(re),{refs:X}=ce(oe({nav:y,id:N}),"page"),H=g(S,X.modalElement),W=n.useMemo((()=>({labelId:`${N}-label`})),[N]);return o.jsx(qe.Provider,{value:W,children:o.jsx(s,r(l({},R),{getRootRef:H,tabIndex:-1,role:"dialog","aria-modal":"true","aria-labelledby":W.labelId,id:N,baseClassName:a("vkuiModalPage","ios"===T&&"vkuiModalPage--ios",P&&"vkuiModalPage--desktop","regular"===F&&"vkuiInternalModalPage--sizeX-regular","string"==typeof O&&Qe[O]),children:o.jsx("div",{className:"vkuiModalPage__in-wrap",style:{maxWidth:"number"==typeof O?O:void 0,height:M},ref:X.innerElement,children:o.jsxs("div",{className:"vkuiModalPage__in",children:[o.jsx("div",{className:"vkuiModalPage__header",ref:X.headerElement,children:d}),o.jsxs("div",{className:"vkuiModalPage__content-wrap",children:[o.jsx("div",r(l({className:"vkuiModalPage__content",ref:K(X.contentElement,x)},C&&{"data-testid":C}),{children:o.jsx("div",{className:"vkuiModalPage__content-in",children:t})})),o.jsx("div",{ref:X.bottomInset,className:"vkuiModalPage__bottom-inset"})]}),z&&o.jsx(Ae,{"data-testid":_,onClick:v||D.onClose})]})})}))})},Je=({containerWidth:e=0,layerWidth:t=0,slides:n=[],viewportOffsetWidth:i=0,align:o,isCenterWithCustomWidth:s})=>{switch(o){case"left":return e-t;case"right":return i-t;case"center":if(s&&n.length){const{coordX:e,width:t}=n[n.length-1];return i/2-e-t/2}return i-(e-i)/2-t}},Ue=({slides:e=[],viewportOffsetWidth:t=0,isCenterWithCustomWidth:n})=>{if(n&&e.length){const{width:n,coordX:i}=e[0];return t/2-i-n/2}return 0},Ze={containerWidth:0,viewportOffsetWidth:0,layerWidth:0,min:0,max:0,slides:[],isFullyVisible:!0},et={animation:void 0,shiftX:0,dragging:!1,deltaX:0,indent:0},tt={dark:"vkuiBaseGallery__bullets--dark",light:"vkuiBaseGallery__bullets--light"},nt=e=>{var{bullets:t=!1,getRootRef:d,children:c,slideWidth:u="100%",slideIndex:v=0,dragDisabled:m=!1,onDragStart:p,onDragEnd:f,onChange:x,onPrevClick:y,onNextClick:b,align:k="left",showArrows:w,getRef:M,arrowSize:C="l"}=e,_=i(e,["bullets","getRootRef","children","slideWidth","slideIndex","dragDisabled","onDragStart","onDragEnd","onChange","onPrevClick","onNextClick","align","showArrows","getRef","arrowSize"]);const S=n.useRef({}),E=n.useRef(Ze),[R,j]=n.useState(et),N=g(d),B=g(M),{window:T}=I(),A=fe(),F="custom"===u&&"center"===k,P=e=>{var t;const n=null!==(t=E.current.max)&&void 0!==t?t:0;var i;const o=null!==(i=E.current.min)&&void 0!==i?i:0;return e<o?o:e>n?n:e},z=e=>{var t;if(E.current.isFullyVisible)return 0;const n=(null===(t=E.current.slides)||void 0===t?void 0:t.length)?E.current.slides[e]:null;if(n){const{coordX:e,width:t}=n;var i;return F?(null!==(i=E.current.viewportOffsetWidth)&&void 0!==i?i:0)/2-e-t/2:P(-1*e)}return 0},O=()=>{var e;const t=null!==(e=E.current.max)&&void 0!==e?e:0;var n;const i=null!==(n=E.current.min)&&void 0!==n?n:0,o=R.shiftX+R.deltaX;return o>t?t+Number((o-t)/3):o<i?i+Number((o-i)/3):o},D=(e={})=>{var t,i,o,s,a;const d=null!==(a=n.Children.map(c,((e,t)=>{const n=S.current[`slide-${t}`];var i,o;return{coordX:null!==(i=null==n?void 0:n.offsetLeft)&&void 0!==i?i:0,width:null!==(o=null==n?void 0:n.offsetWidth)&&void 0!==o?o:0}})))&&void 0!==a?a:[];var u;const h=null!==(u=null===(t=N.current)||void 0===t?void 0:t.offsetWidth)&&void 0!==u?u:0;var m;const g=null!==(m=null===(i=B.current)||void 0===i?void 0:i.offsetWidth)&&void 0!==m?m:0,p=d.reduce(((e,t)=>t.width+e),0),f=d.length<=E.current.slides.length||(null===(o=E.current.slides[v])||void 0===o?void 0:o.coordX)!==(null===(s=d[v])||void 0===s?void 0:s.coordX);E.current={containerWidth:h,viewportOffsetWidth:g,layerWidth:p,max:Ue({slides:d,viewportOffsetWidth:g,isCenterWithCustomWidth:F}),min:Je({containerWidth:h,layerWidth:p,slides:d,viewportOffsetWidth:g,isCenterWithCustomWidth:F,align:k}),slides:d,isFullyVisible:p<=h},j((t=>{var n;return r(l({},t),{shiftX:f?z(v):t.shiftX,animation:null!==(n=e.animation)&&void 0!==n?n:t.shiftX===P(t.shiftX)})}))};de(T,"resize",(()=>{void 0!==R.animation&&D({animation:!1})})),h((()=>{D({animation:!1})}),[c,k,u]),h((()=>{void 0!==R.animation&&j((e=>r(l({},e),{animation:!0,deltaX:0,shiftX:z(null!=v?v:0)})))}),[v]);const X=!m&&!E.current.isFullyVisible,H=R.dragging?O():R.shiftX,W={WebkitTransform:`translateX(${H}px)`,transform:`translateX(${H}px)`,WebkitTransition:R.animation?"-webkit-transform 0.24s cubic-bezier(.1, 0, .25, 1)":"none",transition:R.animation?"transform 0.24s cubic-bezier(.1, 0, .25, 1)":"none"},Y=!E.current.isFullyVisible&&R.shiftX<0;var L;const G=!E.current.isFullyVisible&&("left"===k&&E.current.containerWidth-R.shiftX<(null!==(L=E.current.layerWidth)&&void 0!==L?L:0)||"left"!==k&&v<E.current.slides.length-1);return o.jsxs(s,r(l({},_),{baseClassName:a("vkuiBaseGallery","center"===k&&"vkuiBaseGallery--align-center","custom"===u&&"vkuiBaseGallery--custom-width",X&&"vkuiBaseGallery--draggable"),getRootRef:N,children:[o.jsx(ae,{className:"vkuiBaseGallery__viewport",onStartX:e=>{e.originalEvent.stopPropagation(),X&&(null==p||p(e),j((e=>r(l({},e),{animation:!1}))))},onMoveX:e=>{X&&(e.originalEvent.preventDefault(),e.isSlideX&&R.deltaX!==e.shiftX&&j((t=>r(l({},t),{deltaX:e.shiftX,dragging:e.isSlideX}))))},onEnd:e=>{if(X){const t=e.isSlide?(e=>{const t=R.deltaX/e.duration*240*.6;var n;const i=R.shiftX+R.deltaX+t-(null!==(n=E.current.max)&&void 0!==n?n:0),o=R.deltaX<0?1:-1;let s=E.current.slides.reduce(((e,t,n)=>Math.abs(E.current.slides[e].coordX+i)<Math.abs(t.coordX+i)?e:n),v);if(s===v){let e=v+o;e>=0&&e<E.current.slides.length&&Math.abs(R.deltaX)>.05*E.current.slides[e].width&&(s=e)}return s})(e):null!=v?v:0;null==f||f(e,t);const n={animation:!0,dragging:!1,deltaX:0},i=O();t!==v&&(n.shiftX=i),j((e=>l({},e,n))),t!==v&&(null==x||x(t))}},style:{width:"custom"===u?"100%":u},getRootRef:B,noSlideClick:!0,children:o.jsx("div",{className:"vkuiBaseGallery__layer",style:W,children:n.Children.map(c,((e,t)=>o.jsx("div",{className:"vkuiBaseGallery__slide",ref:e=>((e,t)=>{S.current[`slide-${t}`]=e})(e,t),children:e},`slide-${t}`)))})}),t&&o.jsx("div",{"aria-hidden":!0,className:a("vkuiBaseGallery__bullets",tt[t]),children:n.Children.map(c,((e,t)=>o.jsx("div",{className:a("vkuiBaseGallery__bullet",t===v&&"vkuiBaseGallery__bullet--active")},t)))}),w&&A&&Y&&o.jsx(je,{className:"vkuiBaseGallery__arrow",direction:"left",onClick:e=>{null==x||x(v-1),null==y||y(e)},size:C}),w&&A&&G&&o.jsx(je,{className:"vkuiBaseGallery__arrow",direction:"right",onClick:e=>{null==x||x(v+1),null==b||b(e)},size:C})]}))},it={canSlideLeft:!0,canSlideRight:!0,isDraggable:!0},ot={viewportOffsetWidth:0,slides:[],isFullyVisible:!0,loopPoints:[],contentSize:0,snaps:[]};function st(e,t,n){let i=n;const o=[],s=1===e?0:t.length-1,r=1===e?t.length-1:0;for(let a=s;(1===e?a<=r:a>=r)&&i>0;a+=e){const e=t[a].width;i>0&&o.push(a),i-=e}return o}function rt(e,t,n,i){const{contentSize:o,slides:s,snaps:r}=n,a="start"===t,l=a?-o:o;return e.map((e=>{const t=a?0:-o,n=a?o:0,d=a?r[e]+i+l:r[e]-s[e].width+l-r[0];return{index:e,target:e=>e>=d?t:n}}))}const at=(lt=.8,dt=1,function(e){const t=e,n=3*lt,i=3*(dt-lt)-n;return(1-n-i)*Math.pow(t,3)+i*Math.pow(t,2)+n*t});var lt,dt;function ct(){const e=n.useRef([]);return{getAnimateFunction:function(t){return()=>{!function({duration:e,timing:t,draw:n,animationQueue:i=[]}){if(!k)return;let o;requestAnimationFrame((function s(r){o||(o=r);let a=Math.min((r-o)/e,1);const l=t(a);n(l),a<1?requestAnimationFrame(s):(i.shift(),i.length>0&&i[0]())}))}({duration:240,timing:at,animationQueue:e.current,draw:t})}},addToAnimationQueue:function(t){e.current.push(t)},startAnimation:function(){1===e.current.length&&e.current[0]()}}}const ut={dark:"vkuiBaseGallery__bullets--dark",light:"vkuiBaseGallery__bullets--light"},ht=e=>{var{bullets:t=!1,getRootRef:d,children:c,slideWidth:u="100%",slideIndex:v=0,dragDisabled:m=!1,onDragStart:p,onDragEnd:f,onChange:x,onPrevClick:y,onNextClick:b,align:k="left",showArrows:w,getRef:M,arrowSize:C="l"}=e,_=i(e,["bullets","getRootRef","children","slideWidth","slideIndex","dragDisabled","onDragStart","onDragEnd","onChange","onPrevClick","onNextClick","align","showArrows","getRef","arrowSize"]);const S=n.useRef({}),E=n.useRef(ot),R=g(d),j=g(M),N=n.useRef(null),B=n.useRef(null),T=n.useRef(0),A=n.useRef(0),F=n.useRef(!1),{addToAnimationQueue:P,getAnimateFunction:z,startAnimation:O}=ct(),[D,X]=n.useState(it),{window:H}=I(),W=fe(),Y="custom"===u&&"center"===k,L=(e,t=!1)=>{E.current.loopPoints.forEach((t=>{const{target:n,index:i}=t,o=S.current[i];o&&(o.style.transform=`translate3d(${n(e)}px, 0, 0)`)})),N.current&&(N.current.style.transform=`translate3d(${e}px, 0, 0)`,N.current.style.transition=t?"transform 240ms cubic-bezier(.1, 0, .25, 1)":"")},G=(e,t=!1)=>{const{snaps:n,contentSize:i,slides:o}=E.current;null!==B.current&&cancelAnimationFrame(B.current),B.current=requestAnimationFrame((()=>{e>n[0]&&(T.current=-i+n[0],e=T.current+A.current);const s=o[o.length-1].width+o[o.length-1].coordX;e<=-s&&(T.current=Math.abs(A.current)+n[0]),L(e,t)}))},$=()=>{if(!R.current||!j.current)return;let e=n.Children.map(c,((e,t)=>{const n=S.current[t]||{offsetLeft:0,offsetWidth:0};return{coordX:n.offsetLeft,width:n.offsetWidth}}))||[];const t=R.current.offsetWidth,i=j.current.offsetWidth,o=e.reduce(((e,t)=>t.width+e),0);if("center"===k){const n=(t-e[0].width)/2;e=e.map((e=>({width:e.width,coordX:e.coordX-n})))}E.current=r(l({},E.current),{viewportOffsetWidth:i,slides:e,isFullyVisible:o<=t});const s=e.map(((e,t)=>function(e,t,n){if(t.isFullyVisible||!t.slides.length)return 0;const i=t.slides[e];if(i){const{coordX:e,width:o}=i;return n?t.viewportOffsetWidth/2-e-o/2:-1*e}return 0}(t,E.current,Y)));let a=-s[s.length-1]+e[e.length-1].width;"center"===k&&(a+=s[0]),E.current.snaps=s,E.current.contentSize=a,E.current.loopPoints=function(e,t){const{slides:n,snaps:i}=e,o=st(-1,n,i[0]);return[...rt(st(1,n,t-i[0]),"start",e,t),...rt(o,"end",e,t)]}(E.current,t),X({canSlideLeft:!E.current.isFullyVisible,canSlideRight:!E.current.isFullyVisible,isDraggable:!(m||E.current.isFullyVisible)}),T.current=s[v],F.current=!0,G(T.current)};de(H,"resize",(()=>{F.current&&$()})),h((function(){if(!F.current)return;const{snaps:e,slides:t}=E.current,n=e[v];let i=T.current;if(n===e[0]&&T.current<=e[e.length-1]){const o=Math.abs(e[e.length-1])+t[t.length-1].width+i;P(z((s=>{const r=i+s*o*-1;L(r),r<=e[e.length-1]-t[t.length-1].width&&requestAnimationFrame((()=>{T.current=n,L(e[0])}))})))}else n===e[e.length-1]&&T.current===e[0]?(i=n-t[t.length-1].width,P((()=>{requestAnimationFrame((()=>{const e=n-t[t.length-1].width;L(e),z((e=>{L(i+e*t[t.length-1].width)}))()}))}))):P((()=>{const e=Math.abs(n-i);let t=i<=n?1:-1;z((n=>{L(i+n*e*t)}))()}));O(),T.current=n}),[v]),h((()=>{$()}),[c,k,u]);const{canSlideLeft:V,canSlideRight:q,isDraggable:Q}=D;return o.jsxs(s,r(l({},_),{baseClassName:a("vkuiBaseGallery","custom"===u&&"vkuiBaseGallery--custom-width",Q&&"vkuiBaseGallery--draggable"),getRootRef:R,children:[o.jsx(ae,{className:"vkuiBaseGallery__viewport",onStartX:e=>{e.originalEvent.stopPropagation(),D.isDraggable&&(null==p||p(e),T.current=E.current.snaps[v],A.current=0)},onMoveX:e=>{D.isDraggable&&(e.originalEvent.preventDefault(),e.isSlideX&&A.current!==e.shiftX&&(A.current=e.shiftX,G(T.current+A.current)))},onEnd:e=>{if(D.isDraggable){let t=v;if(e.isSlide&&(t=function(e,t,n,i){const o=n+i,s=i<0?1:-1;let r=e.reduce(((t,n,i)=>Math.abs(e[t].coordX+o)<Math.abs(n.coordX+o)?t:i),t);if(r===t){let n=t+s;return n>=0&&n<e.length?Math.abs(i)>.05*e[n].width?n:r:s<0?(n+e.length)%e.length:n%e.length}return r}(E.current.slides,v,T.current,A.current)),null==f||f(e,t),t!==v)T.current=T.current+A.current,null==x||x(t);else{const e=E.current.snaps[t];G(e,!0)}}},style:{width:"custom"===u?"100%":u},getRootRef:j,noSlideClick:!0,children:o.jsx("div",{className:"vkuiBaseGallery__layer",ref:N,children:n.Children.map(c,((e,t)=>o.jsx("div",{className:"vkuiBaseGallery__slide",ref:e=>{return n=e,i=t,void(S.current[i]=n);var n,i},children:e},`slide-${t}`)))})}),t&&o.jsx("div",{"aria-hidden":!0,className:a("vkuiBaseGallery__bullets",ut[t]),children:n.Children.map(c,((e,t)=>o.jsx("div",{className:a("vkuiBaseGallery__bullet",t===v&&"vkuiBaseGallery__bullet--active")},t)))}),w&&W&&V&&o.jsx(je,{className:"vkuiBaseGallery__arrow",direction:"left",onClick:e=>{null==x||x((v-1+E.current.slides.length)%E.current.slides.length),null==y||y(e)},size:C}),w&&W&&q&&o.jsx(je,{className:"vkuiBaseGallery__arrow",direction:"right",onClick:e=>{null==x||x((v+1)%E.current.slides.length),null==b||b(e)},size:C})]}))},vt=e=>{var{initialSlideIndex:t=0,children:s,timeout:a=0,onChange:d,bullets:c,looped:u}=e,h=i(e,["initialSlideIndex","children","timeout","onChange","bullets","looped"]);const[v,m]=n.useState(t),g="number"==typeof h.slideIndex;var p;const f=g?null!==(p=h.slideIndex)&&void 0!==p?p:0:v,x=n.useMemo((()=>n.Children.toArray(s).filter((e=>Boolean(e)))),[s]),y=x.length,b=te(),k=n.useCallback((e=>{e!==f&&(!g&&m(e),d&&d(e))}),[g,d,f]);!function(e,t,i){const{document:o}=I(),s=J(i);n.useEffect((function(){if(!o||!e)return;let t=null;const n=()=>{t&&(clearTimeout(t),t=null)},i=()=>{switch(o.visibilityState){case"visible":n(),t=setTimeout(s,e);break;case"hidden":n()}};return i(),o.addEventListener("visibilitychange",i),()=>{n(),o.removeEventListener("visibilitychange",i)}}),[o,e,t,s])}(a,f,(()=>k((f+1)%y)));const w=y>0?$(f,0,y-1):f;if(n.useEffect((()=>{d&&w!==f&&d(w),m(w)}),[d,w,f]),!b)return null;const M=u?ht:nt;return o.jsx(M,r(l({dragDisabled:g&&!d},h),{bullets:y>0&&c,slideIndex:w,onChange:k,children:x}))},mt=48,gt=e=>{var{src:t=[],size:n=mt,className:s,children:d}=e,c=i(e,["src","size","className","children"]);return o.jsxs(ke,r(l({},c),{size:n,className:a("vkuiGridAvatar",s),children:[o.jsx("div",{className:"vkuiGridAvatar__in","aria-hidden":!0,children:t.map(((e,t)=>t<4?o.jsx("div",{className:"vkuiGridAvatar__item",style:{backgroundImage:`url(${e})`}},t):null))}),d]}))};gt.Badge=e=>{var{className:t}=e,s=i(e,["className"]);const{size:d}=n.useContext(me);return o.jsx(ke.Badge,r(l({},s),{className:a("vkuiGridAvatarBadge",d<96&&"vkuiGridAvatarBadge--shifted",t)}))};const pt=U.lazy((()=>Z((()=>t.import("./MarkdownText-legacy-BoKi8tc7.js")),void 0,t.meta.url)));function ft(e){return new Date(1e3*e).toLocaleString()}const xt=({ticket:e})=>{const t=e.media.filter((e=>e.mimetype.includes("image"))),i=e.media.filter((e=>!e.mimetype.includes("image"))),[s,r]=n.useState(!1),a=o.jsx("div",{className:"gallery-overlay",children:o.jsx($e,{activeModal:"gallery",children:o.jsx(Ke,{id:"gallery",onClose:()=>r(!1),style:{background:"none"},children:o.jsx(vt,{slideWidth:"100%",bullets:"dark",showArrows:!0,looped:!0,children:t.map(((e,t)=>o.jsx("img",{src:e.url,alt:`image-${t}`,style:{width:"100%",height:"100%"}},t)))})})})});return o.jsxs("div",{children:[o.jsxs("div",{className:"message",children:[t.length>0&&o.jsx("div",{className:"message__img",onClick:()=>r(!0),children:o.jsx(gt,{src:t.slice(0,3).map((e=>e.url))})}),o.jsxs("div",{className:"message__content",children:[o.jsx("div",{className:"message__title",children:e.title}),o.jsx("div",{className:"message__description",children:o.jsx(pt,{text:e.description})}),e.groups.length>0&&o.jsx("div",{className:"message__tags",children:e.groups.join(", ")}),o.jsx("div",{className:"message__date",children:ft(e.time)})]})]}),i.length>0&&o.jsx("div",{className:"message",children:o.jsxs("div",{className:"message__content",children:[i.map((e=>o.jsxs("a",{href:e.url,download:e.name,target:"_blank",className:"file",children:[o.jsx("div",{className:"file__icon",children:o.jsx(Me,{})}),o.jsx("div",{className:"file__content",children:o.jsx("div",{className:"file__name",children:e.name})})]},e.index))),o.jsx("div",{className:"message__date",children:ft(e.time)})]})}),s&&ee.createPortal(a,document.getElementById("gallery-portal"))]})};e({PreviewMessage:xt,default:xt})}}}));
